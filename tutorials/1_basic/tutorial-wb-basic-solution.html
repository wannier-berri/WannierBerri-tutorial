

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Basic tutorial: Interpolating bands, Berry curvatures, and integrating them &mdash; Wannier Berri 1.6.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/style.css?v=88c5e859" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
    <link rel="shortcut icon" href="../../_static/WB-logo.ico"/>
    <link rel="canonical" href="https://tutorial.wannier-berri.org/tutorials/1_basic/tutorial-wb-basic-solution.html" />
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=d6a008b6"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Wannier Berri 1.6.1 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="WannierBerri advanced tutorial - Fermi surface and Fermi sea calculation of the Berry curvature dipole" href="../2_fermi_sea_vs_fermi_surface/solution/tutorial_sea_vs_surface_solution.html" />
    <link rel="prev" title="Wannier Berri Tutorial" href="../../index.html" />
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #009C46" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/tutorial.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Basic tutorial: Interpolating bands, Berry curvatures, and integrating them</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Preparation-of-a-calculation:">Preparation of a calculation:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Reading-the-system">Reading the system</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Interpolation-on-a-path">Interpolation on a path</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Running-a-calculation:-calculators-and-results">Running a calculation: calculators and results</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Tabulating-Berry-curvature-and-spin">Tabulating Berry curvature and spin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Running-a-calculation">Running a calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Alternative-shortcut:">Alternative shortcut:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Plotting-the-results">Plotting the results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Problem-1:">Problem 1:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Get-the-data-and-do-whatever-you-want">Get the data and do whatever you want</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Calaculation-on-a-3D-grid">Calaculation on a 3D grid</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#We-can-use-the-same-tabulators,-but-now-we-pack-them-into-TabulatorAll-in-%22grid%22-mode">We can use the same tabulators, but now we pack them into TabulatorAll in “grid” mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#And-we-run-the-calculation-in-the-same-way">And we run the calculation in the same way</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Writing-the-FermiSurfer-files">Writing the FermiSurfer files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Analyze-the-tabulated-data">Analyze the tabulated data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Problem-2-:">Problem 2 :</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fill-the-missing-parts-and-evaluate-the-Berry-curvature-summed-over-all-states-below-EF-=-12.6-eV.-Plot-in-on-a-plane-k3=const-(in-reduced-coordinates)">fill the missing parts and evaluate the Berry curvature summed over all states below EF = 12.6 eV. Plot in on a plane k3=const (in reduced coordinates)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Integration-on-a-grid:-anomalous-Hall-conductivity">Integration on a grid: anomalous Hall conductivity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Problem-3-:">Problem 3 :</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Tetrahedron-method">Tetrahedron method</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Optical-conductivity">Optical conductivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="#All-in-one">All in one</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2_fermi_sea_vs_fermi_surface/solution/tutorial_sea_vs_surface_solution.html">WannierBerri advanced tutorial - Fermi surface and Fermi sea calculation of the Berry curvature dipole</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_spin_hall/solution/tutorial_spin_hall.html">Spin Hall conductivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_DIY/tutorial-wb-DIY-solution.html">DIY tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5_symmetrization/tutorial_symmetrization-solution.html">Symmetrization of Wannier Hamiltonian and matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_wannierisation/wannierise.html">Wannierisation (including SAWF)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_find_projections/find_projections.html">Finding initial projections based on symmetry indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_GPAW/1.diamond/diamond.html">GPAW + WannierBerri: spinless bandstructure (diamond)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_GPAW/2.Fe/bccFe.html">GPAW + WannierBerri: Magnetism and spin-orbit coupling (bcc Fe)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8_GPAW/3.MnTe/mnte.html">GPAW + WannierBerri: Altermagnet MnTe</a></li>
</ul>

    <a href="genindex.html">Index</a>
    <a href="http://wannier-berri.org">Back to Wannier-Berri.org</a>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #009C46" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Wannier Berri</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Basic tutorial: Interpolating bands, Berry curvatures, and integrating them</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Basic-tutorial:-Interpolating-bands,-Berry-curvatures,-and-integrating-them">
<h1>Basic tutorial: Interpolating bands, Berry curvatures, and integrating them<a class="headerlink" href="#Basic-tutorial:-Interpolating-bands,-Berry-curvatures,-and-integrating-them" title="Link to this heading"></a></h1>
<p>In this tutorial we will see how to compute band energies, Berry curvature, spins and anomalous Hall conductivity using WannierBerri code and further integrate them over the Brillouin zone to obtain Anomalous Hall conductivity, and other quantities of interest.</p>
<section id="Preparation-of-a-calculation:">
<h2>Preparation of a calculation:<a class="headerlink" href="#Preparation-of-a-calculation:" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>import the needed modules</p></li>
<li><p>initialize a <a class="reference external" href="https://wannier-berri.org/docs/parallel.html">Parallel() or Serial()</a> class</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Preliminary

# Set environment variables - not mandatory but recommended if you use Parallel()
#import os
#os.environ[&#39;OPENBLAS_NUM_THREADS&#39;] = &#39;1&#39;
#os.environ[&#39;MKL_NUM_THREADS&#39;] = &#39;1&#39;


import wannierberri as wberri
print (f&quot;Using WannierBerri version {wberri.__version__}&quot;)
import numpy as np
import scipy
import matplotlib.pyplot as plt
%matplotlib inline
from termcolor import cprint

#  This block is needed if you run this cell for a second time
#  because one cannot initiate two parallel environments at a time
try:
    parallel.shutdown()
except NameError:
    pass

# Chiose one of the options:

parallel = wberri.Parallel(num_cpus=2)
#parallel = wberri.Parallel()  # automatic detection
#parallel = wberri.Serial()
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Using WannierBerri version 1.2.1
initializing ray with  {&#39;num_cpus&#39;: 2}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-14 14:32:33,054 INFO worker.py:1879 -- Started a local Ray instance. View the dashboard at <span class="ansi-green-intense-fg ansi-bold">http://127.0.0.1:8268 </span>
<span class="ansi-yellow-fg">(raylet)</span> [2025-05-14 15:05:33,010 E 39567 39567] (raylet) node_manager.cc:3287: 2 Workers (tasks / actors) killed due to memory pressure (OOM), 0 Workers crashed due to other reasons at node (ID: af808b920b9118613e7026c3115db53e3f56f1577207cc935a7423ad, IP: 128.179.188.185) over the last time period. To see more information about the Workers killed on this node, use `ray logs raylet.out -ip 128.179.188.185`
<span class="ansi-yellow-fg">(raylet)</span>
<span class="ansi-yellow-fg">(raylet)</span> Refer to the documentation on how to address the out of memory issue: https://docs.ray.io/en/latest/ray-core/scheduling/ray-oom-prevention.html. Consider provisioning more memory on this node or reducing task parallelism by requesting more CPUs per task. To adjust the kill threshold, set the environment variable `RAY_memory_usage_threshold` when starting Ray. To disable worker killing, set the environment variable `RAY_memory_monitor_refresh_ms` to zero.
</pre></div></div>
</div>
</section>
<section id="Reading-the-system">
<h2>Reading the system<a class="headerlink" href="#Reading-the-system" title="Link to this heading"></a></h2>
<p>Now we need to define the system that we are working on. Wannierberri can equally work with Wannier functions obtained by Wannier90 or other code (e.g. ASE or FPLO), as well as tight-binding models. This is done by constructing a <a class="reference external" href="https://wannier-berri.org/docs/system.html">System()</a> class or one of its subclasses. Below, an example for Wannier90 is given; in advanced tutorials, some tight-binding models are also used.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Importing data from wannier90
system=wberri.System_w90(
                        seedname=&#39;w90_files/Fe&#39;,
                        berry=True,   # needed to calculate &quot;external terms&quot; of Berry connection or curvature , reads &quot;.mmn&quot; file
                        spin = True , # needed for spin properties, reads &quot;.spn&quot; file
                        )


# Setting the pointgroup from the symmetry operations
import irrep
spacegroup = irrep.spacegroup.SpaceGroup( cell=(system.real_lattice, [[0,0,0]], [1]),   # only 1 Fe atoms at origin
                                           spinor = True,
                                           magmom = [[0,0,1]],   # magnetic moment along z
                                           include_TR = True,   # include symmetries that flip the spin
                                        )
system.set_pointgroup(spacegroup=spacegroup)

# generators=[&quot;Inversion&quot;,&quot;C4z&quot;,&quot;TimeReversal*C2x&quot;]
# system.set_pointgroup(symmetry_gen=generators)
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
kwargs for eig are {&#39;read_npz&#39;: True, &#39;write_npz&#39;: True}
calling w90 file with w90_files/Fe, eig, tags=[&#39;data&#39;], read_npz=True, write_npz=True, kwargs={}
kwargs for mmn are {&#39;read_npz&#39;: True, &#39;write_npz&#39;: True}
calling w90 file with w90_files/Fe, mmn, tags=[&#39;data&#39;, &#39;neighbours&#39;, &#39;G&#39;], read_npz=True, write_npz=True, kwargs={&#39;npar&#39;: 32}
kwargs for spn are {&#39;read_npz&#39;: True, &#39;write_npz&#39;: False}
calling w90 file with w90_files/Fe, spn, tags=[&#39;data&#39;], read_npz=True, write_npz=False, kwargs={}
----------
 SPN
---------

reading w90_files/Fe.spn : Created on  7May2022 at 16: 2:47
----------
 SPN OK
---------

Reading restart information from file w90_files/Fe.chk :
Time to read .chk : 0.005883693695068359
setting Rvec
expjphase1 (1, 18, 12)
Real-space lattice:
 [[ 1.4349963  1.4349963  1.4349963]
 [-1.4349963  1.4349963  1.4349963]
 [-1.4349963 -1.4349963  1.4349963]]
Number of wannier functions: 18
Number of R points: 113
Recommended size of FFT grid [4 4 4]
</pre></div></div>
</div>
</section>
<section id="Interpolation-on-a-path">
<h2>Interpolation on a path<a class="headerlink" href="#Interpolation-on-a-path" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Evaluate bands, Berry curvature, and spin along a path GHPNG


# all kpoints given in reduced coordinates
path=wberri.Path(system,
                 nodes=[
        [0.0000, 0.0000, 0.0000 ],   #  G
        [0.500 ,-0.5000, -0.5000],   #  H
        [0.7500, 0.2500, -0.2500],   #  P
        [0.5000, 0.0000, -0.5000],   #  N
        [0.0000, 0.0000, 0.000  ] ] , #  G
                 labels=[&quot;G&quot;,&quot;H&quot;,&quot;P&quot;,&quot;N&quot;,&quot;G&quot;],
                 length=200 )   # length [ Ang] ~= 2*pi/dk

# uncomment some of these lines to see what path you have generated

#print (path)

#print (path.getKline())

#for K in path.get_K_list():
#    print (K)

#print (np.array([K.K for K in path.get_K_list()]))
<br/><br/></pre></div>
</div>
</div>
</section>
<section id="Running-a-calculation:-calculators-and-results">
<h2>Running a calculation: calculators and results<a class="headerlink" href="#Running-a-calculation:-calculators-and-results" title="Link to this heading"></a></h2>
<p>The calculation is called using the function <code class="docutils literal notranslate"><span class="pre">`run()</span></code> &lt;<a class="reference external" href="https://wannier-berri.org/docs/run.html">https://wannier-berri.org/docs/run.html</a>&gt;`__ :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>result=wberri.run(system,
                  grid=path,
                  calculators = {&quot;key&quot; : calculator},
                  parallel = parallel,
                  print_Kpoints = False)
</pre></div>
</div>
<p>Here, apart from the already known ingredients, we need to define objects of some subclass of <code class="docutils literal notranslate"><span class="pre">`Calculator</span></code> &lt;<a class="reference external" href="https://wannier-berri.org/docs/calculators.html#wannierberri.calculators.Calculator">https://wannier-berri.org/docs/calculators.html#wannierberri.calculators.Calculator</a>&gt;`__. A Calculator is a callable object which returns some <code class="docutils literal notranslate"><span class="pre">`Result</span></code> &lt;<a class="reference external" href="https://wannier-berri.org/docs/result.html">https://wannier-berri.org/docs/result.html</a>&gt;`__. If you code another calculator, you can calculate other things using the machinery of WannierBerri, but that is not a part of this basic tutorial.</p>
<p>Further, results are packed into <code class="docutils literal notranslate"><span class="pre">`ResultDict</span></code> &lt;<a class="reference external" href="https://wannier-berri.org/docs/result.html#wannierberri.result.ResultDict">https://wannier-berri.org/docs/result.html#wannierberri.result.ResultDict</a>&gt;`__ and returned.</p>
</section>
<section id="Tabulating-Berry-curvature-and-spin">
<h2>Tabulating Berry curvature and spin<a class="headerlink" href="#Tabulating-Berry-curvature-and-spin" title="Link to this heading"></a></h2>
<p>To run a tabulation one needs to compose a dictionary, where keys are any arbitrary strings to label further tabulation results, and the values are subclasses of <code class="docutils literal notranslate"><span class="pre">`Tabulator</span></code> &lt;<a class="reference external" href="https://wannier-berri.org/docs/calculators.html#wannierberri.calculators.tabulate.Tabulator">https://wannier-berri.org/docs/calculators.html#wannierberri.calculators.tabulate.Tabulator</a>&gt;`__</p>
<p>Next, we pack them into another class called <code class="docutils literal notranslate"><span class="pre">`TabulatorAll</span></code> &lt;<a class="reference external" href="https://wannier-berri.org/docs/calculators.html#wannierberri.calculators.TabulatorAll">https://wannier-berri.org/docs/calculators.html#wannierberri.calculators.TabulatorAll</a>&gt;`__, which represents a complex <code class="docutils literal notranslate"><span class="pre">`Calculator</span></code> &lt;<a class="reference external" href="https://wannier-berri.org/docs/calculators.html#wannierberri.calculators.Calculator">https://wannier-berri.org/docs/calculators.html#wannierberri.calculators.Calculator</a>&gt;`__</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span>tabulators = { &quot;energy&quot;: wberri.calculators.tabulate.Energy(),
               &quot;berry_curvature&quot; : wberri.calculators.tabulate.BerryCurvature(),
               &quot;spin&quot; : wberri.calculators.tabulate.Spin(),
             }

tab_all_path = wberri.calculators.TabulatorAll(
                    tabulators,
                    ibands = np.arange(0,18),
                    mode = &quot;path&quot;
                        )
</pre></div>
</div>
</div>
<section id="Running-a-calculation">
<h3>Running a calculation<a class="headerlink" href="#Running-a-calculation" title="Link to this heading"></a></h3>
<p>Now run the calculation using the function <code class="docutils literal notranslate"><span class="pre">`run()</span></code> &lt;<a class="reference external" href="https://wannier-berri.org/docs/run.html">https://wannier-berri.org/docs/run.html</a>&gt;`__ . This will return an object of class <code class="docutils literal notranslate"><span class="pre">`ResultDict()</span></code> &lt;<a class="reference external" href="https://wannier-berri.org/docs/result.html#wannierberri.result.ResultDict">https://wannier-berri.org/docs/result.html#wannierberri.result.ResultDict</a>&gt;`__ This object contains all results of the calculations, but in this case we have only one, which is marked <code class="docutils literal notranslate"><span class="pre">&quot;tabulate&quot;</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>result=wberri.run(system,
                  grid=path,
                  calculators = {&quot;tabulate&quot; : tab_all_path},
                  parallel = parallel,
                  print_Kpoints = False)

print (result.results)
path_result = result.results[&quot;tabulate&quot;]
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">Starting run()</span>
<span class="ansi-cyan-intense-fg ansi-bold">Using the follwing calculators :
############################################################
</span>
<span class="ansi-magenta-intense-fg ansi-bold"> &#39;tabulate&#39; </span> : <span class="ansi-yellow-intense-fg ansi-bold"> &lt;wannierberri.calculators.tabulate.TabulatorAll object at 0x754f2cfa9610&gt; </span> :
    TabulatorAll - a pack of all k-resolved calculators (Tabulators)

 Includes the following tabulators :
--------------------------------------------------
 &#34;energy&#34; : &lt;wannierberri.calculators.tabulate.Energy object at 0x754f7c0bb2f0&gt; : calculator not described

 &#34;berry_curvature&#34; : &lt;wannierberri.calculators.tabulate.BerryCurvature object at 0x754f2cfaa2d0&gt; : calculator not described

 &#34;spin&#34; : &lt;wannierberri.calculators.tabulate.Spin object at 0x754f2cfab5c0&gt; :  Spin expectation :math:` \langle u | \mathbf{\sigma} | u \rangle`

 &#34;Energy&#34; : &lt;wannierberri.calculators.tabulate.Energy object at 0x754f2cfab320&gt; : calculator not described

--------------------------------------------------

<span class="ansi-cyan-intense-fg ansi-bold">############################################################</span>
Calculation along a path - checking calculators for compatibility
tabulate &lt;wannierberri.calculators.tabulate.TabulatorAll object at 0x754f2cfa9610&gt;
All calculators are compatible
Symmetrization switched off for Path
Grid is regular
The set of k points is a Path() with 215 points and labels {0: &#39;G&#39;, 70: &#39;H&#39;, 130: &#39;P&#39;, 165: &#39;N&#39;, 214: &#39;G&#39;}
generating K_list
Done
Done, sum of weights:215.0
processing 215 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/stepan/github/wannier-berri/wannierberri/grid/path.py:163: UserWarning: symmetry is not used for a tabulation along path
  warnings.warn(&#34;symmetry is not used for a tabulation along path&#34;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
time for processing    215 K-points on   2 processes:     1.9922 ; per K-point          0.0093 ; proc-sec per K-point          0.0185
time1 =  0.008013725280761719
Totally processed 215 K-points
run() finished
{&#39;tabulate&#39;: &lt;wannierberri.result.tabresult.TABresult object at 0x754f1ff35820&gt;}
</pre></div></div>
</div>
</section>
<section id="Alternative-shortcut:">
<h3>Alternative shortcut:<a class="headerlink" href="#Alternative-shortcut:" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>path , path_result= wberri.evaluate_k_path(system=system,
                                            nodes=[
        [0.0000, 0.0000, 0.0000 ],   #  G
        [0.500 ,-0.5000, -0.5000],   #  H
        [0.7500, 0.2500, -0.2500],   #  P
        [0.5000, 0.0000, -0.5000],   #  N
        [0.0000, 0.0000, 0.000  ] ] , #  G
                 labels=[&quot;G&quot;,&quot;H&quot;,&quot;P&quot;,&quot;N&quot;,&quot;G&quot;],
                 length=200 ,
                quantities=[&quot;berry_curvature&quot;,&quot;spin&quot;])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">Starting run()</span>
<span class="ansi-cyan-intense-fg ansi-bold">Using the follwing calculators :
############################################################
</span>
<span class="ansi-magenta-intense-fg ansi-bold"> &#39;tabulate&#39; </span> : <span class="ansi-yellow-intense-fg ansi-bold"> &lt;wannierberri.calculators.tabulate.TabulatorAll object at 0x754f7c2bf200&gt; </span> :
    TabulatorAll - a pack of all k-resolved calculators (Tabulators)

 Includes the following tabulators :
--------------------------------------------------
 &#34;berry_curvature&#34; : &lt;wannierberri.calculators.tabulate.BerryCurvature object at 0x754f0d253ad0&gt; : calculator not described

 &#34;spin&#34; : &lt;wannierberri.calculators.tabulate.Spin object at 0x754f0cb28050&gt; :  Spin expectation :math:` \langle u | \mathbf{\sigma} | u \rangle`

 &#34;Energy&#34; : &lt;wannierberri.calculators.tabulate.Energy object at 0x754f1ff750a0&gt; : calculator not described

--------------------------------------------------

<span class="ansi-cyan-intense-fg ansi-bold">############################################################</span>
Calculation along a path - checking calculators for compatibility
tabulate &lt;wannierberri.calculators.tabulate.TabulatorAll object at 0x754f7c2bf200&gt;
All calculators are compatible
Symmetrization switched off for Path
Grid is regular
The set of k points is a Path() with 215 points and labels {0: &#39;G&#39;, 70: &#39;H&#39;, 130: &#39;P&#39;, 165: &#39;N&#39;, 214: &#39;G&#39;}
generating K_list
Done
Done, sum of weights:215.0
processing 215 K points : in serial.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing    215 K-points in serial:     1.5860 ; per K-point          0.0074 ; proc-sec per K-point          0.0074
time1 =  0.005733966827392578
Totally processed 215 K-points
run() finished
</pre></div></div>
</div>
</section>
<section id="Plotting-the-results">
<h3>Plotting the results<a class="headerlink" href="#Plotting-the-results" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">`TABresult</span></code> &lt;<a class="reference external" href="https://wannier-berri.org/docs/result.html#wannierberri.result.TABresult">https://wannier-berri.org/docs/result.html#wannierberri.result.TABresult</a>&gt;`__ object already provides methods to plot the results. (As well as one can extract the data and plot them by other means). Below let’s plot the interpolated bands and compare with those obtained in QE. (file “bands/Fe_bands_pw.dat” is already provided)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># plot the bands and compare with QuantumEspresso
EF = 12.6
# Import the pre-computed bands from quantum espresso
A = np.loadtxt(open(&quot;bands/Fe_bands_pw.dat&quot;,&quot;r&quot;))
bohr_ang = scipy.constants.physical_constants[&#39;Bohr radius&#39;][0] / 1e-10
alatt = 5.4235* bohr_ang
A[:,0]*= 2*np.pi/alatt
A[:,1]-=EF
# plot it as dots
plt.scatter (A[:,0],A[:,1],s=5,label = &quot;QE&quot;)


path_result.plot_path_fat( path,
              quantity=None,
              save_file=&quot;Fe_bands+QE.pdf&quot;,
              Eshift=EF,
              Emin=-10,  Emax=50,
              iband=None,
              mode=&quot;fatband&quot;,
              fatfactor=20,
              cut_k=False,
              close_fig=False,
              show_fig=False,
              label = &quot;WB&quot;
              )


plt.legend()
plt.show()
plt.close()
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_13_0.png" src="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_13_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># plot the bands and compare with wannier90
A = np.loadtxt(open(&quot;bands/Fe_bands_w90.dat&quot;,&quot;r&quot;))
plt.scatter (A[:,0],A[:,1],s=5,label = &quot;W90&quot;)

path_result.plot_path_fat( path,
              quantity=None,
              save_file=&quot;Fe_bands+w90.pdf&quot;,
              Eshift=0,
              Emin=4,  Emax=20,
              iband=None,
              mode=&quot;fatband&quot;,
              fatfactor=20,
              cut_k=False,
              close_fig=False,
              show_fig=False,
              label = &quot;WB&quot;
              )

plt.legend()

plt.show()
plt.close()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_14_0.png" src="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_14_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># plot the Berry curvature
path_result.plot_path_fat( path,
              quantity=&#39;berry_curvature&#39;,
              component=&#39;z&#39;,
              save_file=None, #&quot;Fe_bands+berry.pdf&quot;,
              Eshift=0,
              Emin=4,  Emax=25,
              iband=None,
              mode=&quot;fatband&quot;,
              fatfactor=4,
              cut_k=False,
              close_fig=False,
              show_fig=False,
              )
plt.show()
plt.close()

# The size of the dots corresponds to the magnitude of BC on a logarithmic scale
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_15_0.png" src="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_15_0.png" />
</div>
</div>
</section>
<section id="Problem-1:">
<h3>Problem 1:<a class="headerlink" href="#Problem-1:" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>modify the path</p></li>
<li><p>plot the “z” component of spin along it (without .</p></li>
<li><p>do <strong>not</strong> plot QE or W90 bands in this case</p></li>
</ul>
<p>Hint : look here for a proper Calculator <a class="reference external" href="https://wannier-berri.org/docs/calculators.html#tabulating">https://wannier-berri.org/docs/calculators.html#tabulating</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># put the necessary code here
<br/><br/><br/><br/><br/></pre></div>
</div>
</div>
</section>
<section id="Get-the-data-and-do-whatever-you-want">
<h3>Get the data and do whatever you want<a class="headerlink" href="#Get-the-data-and-do-whatever-you-want" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>k=path.getKline()
E=path_result.get_data(quantity=&#39;Energy&#39;,iband=(10,11))
curv=path_result.get_data(quantity=&#39;berry_curvature&#39;,iband=(10,11),component=&quot;z&quot;)
print (k.shape, E.shape, curv.shape)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(215,) (215, 2) (215, 2)
</pre></div></div>
</div>
</section>
</section>
<section id="Calaculation-on-a-3D-grid">
<h2>Calaculation on a 3D grid<a class="headerlink" href="#Calaculation-on-a-3D-grid" title="Link to this heading"></a></h2>
<p>Now let’s investigate how Berry curvature behaves in the 3D Brillouin zone. For that we need to set a grid, which can be done in several ways, see input parameters <a class="reference external" href="file:///home/stepan/github/wannier-berri-org/html/docs/grid.html">here</a></p>
<p>Most important to recall, is that in WB one sets two grids : the FFT grid and the K-grid (NKdiv). this is important for running the calculation. However, the final; result depends only on their product.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Set a grid
grid = wberri.Grid(system, length=50 )   # length [ Ang] ~= 2*pi/dk
#grid = wberri.Grid(system, NK=[24,24,24], NKFFT=4)
#grid = wberri.Grid(system, NKdiv=6, NKFFT=4)
<br/><br/><br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Minimal symmetric FFT grid :  [4 4 4]
</pre></div></div>
</div>
<section id="We-can-use-the-same-tabulators,-but-now-we-pack-them-into-TabulatorAll-in-%22grid%22-mode">
<h3>We can use the same tabulators, but now we pack them into TabulatorAll in “grid” mode<a class="headerlink" href="#We-can-use-the-same-tabulators,-but-now-we-pack-them-into-TabulatorAll-in-%22grid%22-mode" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>tabulators = { &quot;Energy&quot;: wberri.calculators.tabulate.Energy(),
               &quot;berry_curvature&quot; : wberri.calculators.tabulate.BerryCurvature(),
             }

tab_all_grid = wberri.calculators.TabulatorAll(
                    tabulators,
                    ibands = np.arange(0,18),
                    mode = &quot;grid&quot;
                        )
</pre></div>
</div>
</div>
</section>
<section id="And-we-run-the-calculation-in-the-same-way">
<h3>And we run the calculation in the same way<a class="headerlink" href="#And-we-run-the-calculation-in-the-same-way" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>result=wberri.run(system,
                  grid=grid,
                  calculators = {&quot;tabulate&quot; : tab_all_grid},
                  parallel = parallel,
                  print_Kpoints = True)

print (result.results)
grid_result = result.results[&quot;tabulate&quot;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">Starting run()</span>
<span class="ansi-cyan-intense-fg ansi-bold">Using the follwing calculators :
############################################################
</span>
<span class="ansi-magenta-intense-fg ansi-bold"> &#39;tabulate&#39; </span> : <span class="ansi-yellow-intense-fg ansi-bold"> &lt;wannierberri.calculators.tabulate.TabulatorAll object at 0x754e886b9100&gt; </span> :
    TabulatorAll - a pack of all k-resolved calculators (Tabulators)

 Includes the following tabulators :
--------------------------------------------------
 &#34;Energy&#34; : &lt;wannierberri.calculators.tabulate.Energy object at 0x754e8852a4b0&gt; : calculator not described

 &#34;berry_curvature&#34; : &lt;wannierberri.calculators.tabulate.BerryCurvature object at 0x754e886ba0f0&gt; : calculator not described

--------------------------------------------------

<span class="ansi-cyan-intense-fg ansi-bold">############################################################</span>
Calculation on  grid - checking calculators for compatibility
tabulate &lt;wannierberri.calculators.tabulate.TabulatorAll object at 0x754e886b9100&gt;
All calculators are compatible
Grid is regular
The set of k points is a Grid() with NKdiv=[5 5 5], NKFFT=[5 5 5], NKtot=[25 25 25]
generating K_list
Done in 0.0002799034118652344 s
excluding symmetry-equivalent K-points from initial grid
Done in 0.003501415252685547 s
K_list contains 18 Irreducible points(14.4%) out of initial 5x5x5=125 grid
Done, sum of weights:1.0000000000000004
iteration 0 - 18 points. New points are:
 K-point 0 : coord in rec.lattice = [   0.000000 ,   0.000000 ,   0.000000 ], refinement level:0, factor = 0.008dK=[0.2 0.2 0.2]
 K-point 1 : coord in rec.lattice = [   0.000000 ,   0.200000 ,   0.000000 ], refinement level:0, factor = 0.032dK=[0.2 0.2 0.2]
 K-point 2 : coord in rec.lattice = [   0.000000 ,   0.400000 ,   0.000000 ], refinement level:0, factor = 0.032dK=[0.2 0.2 0.2]
 K-point 3 : coord in rec.lattice = [   0.200000 ,   0.000000 ,   0.000000 ], refinement level:0, factor = 0.064dK=[0.2 0.2 0.2]
 K-point 4 : coord in rec.lattice = [   0.200000 ,   0.200000 ,   0.200000 ], refinement level:0, factor = 0.016dK=[0.2 0.2 0.2]
 K-point 5 : coord in rec.lattice = [   0.200000 ,   0.600000 ,   0.200000 ], refinement level:0, factor = 0.064dK=[0.2 0.2 0.2]
 K-point 6 : coord in rec.lattice = [   0.400000 ,   0.000000 ,   0.000000 ], refinement level:0, factor = 0.064dK=[0.2 0.2 0.2]
 K-point 7 : coord in rec.lattice = [   0.400000 ,   0.200000 ,   0.000000 ], refinement level:0, factor = 0.064dK=[0.2 0.2 0.2]
 K-point 8 : coord in rec.lattice = [   0.400000 ,   0.200000 ,   0.200000 ], refinement level:0, factor = 0.064dK=[0.2 0.2 0.2]
 K-point 9 : coord in rec.lattice = [   0.400000 ,   0.400000 ,   0.400000 ], refinement level:0, factor = 0.016dK=[0.2 0.2 0.2]
 K-point 10 : coord in rec.lattice = [   0.600000 ,   0.200000 ,   0.000000 ], refinement level:0, factor = 0.12800000000000006dK=[0.2 0.2 0.2]
 K-point 11 : coord in rec.lattice = [   0.600000 ,   0.200000 ,   0.200000 ], refinement level:0, factor = 0.064dK=[0.2 0.2 0.2]
 K-point 12 : coord in rec.lattice = [   0.600000 ,   0.400000 ,   0.200000 ], refinement level:0, factor = 0.064dK=[0.2 0.2 0.2]
 K-point 13 : coord in rec.lattice = [   0.600000 ,   0.400000 ,   0.400000 ], refinement level:0, factor = 0.032dK=[0.2 0.2 0.2]
 K-point 14 : coord in rec.lattice = [   0.800000 ,   0.200000 ,   0.000000 ], refinement level:0, factor = 0.12800000000000006dK=[0.2 0.2 0.2]
 K-point 15 : coord in rec.lattice = [   0.800000 ,   0.200000 ,   0.200000 ], refinement level:0, factor = 0.032dK=[0.2 0.2 0.2]
 K-point 16 : coord in rec.lattice = [   0.800000 ,   0.400000 ,   0.000000 ], refinement level:0, factor = 0.064dK=[0.2 0.2 0.2]
 K-point 17 : coord in rec.lattice = [   0.800000 ,   0.400000 ,   0.200000 ], refinement level:0, factor = 0.064dK=[0.2 0.2 0.2]
processing 18 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing     18 K-points on   2 processes:     2.0430 ; per K-point          0.1135 ; proc-sec per K-point          0.2270
time1 =  0.005402565002441406
setting the grid
setting new kpoints
finding equivalent kpoints
collecting
collecting: to_grid  : 0.0702202320098877
collecting: TABresult  : 0.0002505779266357422
collecting - OK : 0.07048654556274414 (1.5735626220703125e-05)
Totally processed 18 K-points
run() finished
{&#39;tabulate&#39;: &lt;wannierberri.result.tabresult.TABresult object at 0x754e8853c590&gt;}
</pre></div></div>
</div>
</section>
<section id="Writing-the-FermiSurfer-files">
<h3>Writing the FermiSurfer files<a class="headerlink" href="#Writing-the-FermiSurfer-files" title="Link to this heading"></a></h3>
<p>You may see that conversion to text format takes time. so convert only those components that you really need for plotting.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>grid_result.write_frmsf(name=&quot;Fe_grid&quot;, quantity=&quot;berry_curvature&quot;,
                        components=&quot;z&quot;,
                        )
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Enk (25, 25, 25, 18)
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
Xnk (25, 25, 25, 18)
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
using a pool of 32 processes to write txt frmsf of 489 points per process
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(6.911812782287598, 0.005792140960693359)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Now we got some .frmsf files
!ls -al *.frmsf
# !rm *.frmsf
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-rw-rw-r-- 1 stepan stepan 6592280 May 14 14:32 Fe_grid_berry_curvature-z.frmsf
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># let&#39;s look at them using the Fermisurfer! (https://fermisurfer.osdn.jp/)
!fermisurfer Fe_grid_berry_curvature-z.frmsf
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/bin/bash: line 1: fermisurfer: command not found
</pre></div></div>
</div>
</section>
<section id="Analyze-the-tabulated-data">
<h3>Analyze the tabulated data<a class="headerlink" href="#Analyze-the-tabulated-data" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># You may get the data as numpy arrays via:
Energy = grid_result.get_data(iband=5, quantity=&#39;Energy&#39;)
ahc  = grid_result.get_data(iband=5, quantity=&#39;berry_curvature&#39;,component=&#39;z&#39;)
print(ahc.shape,Energy.shape)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(25, 25, 25) (25, 25, 25)
</pre></div></div>
</div>
</section>
<section id="Problem-2-:">
<h3>Problem 2 :<a class="headerlink" href="#Problem-2-:" title="Link to this heading"></a></h3>
</section>
<section id="fill-the-missing-parts-and-evaluate-the-Berry-curvature-summed-over-all-states-below-EF-=-12.6-eV.-Plot-in-on-a-plane-k3=const-(in-reduced-coordinates)">
<h3>fill the missing parts and evaluate the Berry curvature summed over all states below EF = 12.6 eV. Plot in on a plane k3=const (in reduced coordinates)<a class="headerlink" href="#fill-the-missing-parts-and-evaluate-the-Berry-curvature-summed-over-all-states-below-EF-=-12.6-eV.-Plot-in-on-a-plane-k3=const-(in-reduced-coordinates)" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># example : find the total Berry curvature of occupied states
# on the plane (k1,k2), k3=const (in reduced coordinates)
Berry_occ = 0
k3 = 9
EF=12.4
for ib in range(18):
    Energy =
    ahc  =
    ahc [Energy&gt;EF] = 0
    Berry_occ += ahc
    plt.contour(Energy,levels = [EF],linewidths=0.5,colors=&#39;black&#39;)
shw = plt.imshow(Berry_occ,vmin=-10,vmax=10,cmap=&quot;jet&quot;)
bar = plt.colorbar(shw)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
  <span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[19]</span><span class="ansi-green-fg">, line 7</span>
<span class="ansi-red-fg">    </span><span class="ansi-red-fg">Energy =</span>
             ^
<span class="ansi-red-fg">SyntaxError</span><span class="ansi-red-fg">:</span> invalid syntax

</pre></div></div>
</div>
</section>
</section>
<section id="Integration-on-a-grid:-anomalous-Hall-conductivity">
<h2>Integration on a grid: anomalous Hall conductivity<a class="headerlink" href="#Integration-on-a-grid:-anomalous-Hall-conductivity" title="Link to this heading"></a></h2>
<p>Now, after we saw that the Berry curvature changes rapidly in the k-space, we understand that to get the precise value of AHC (<span class="math">\ref{eq:ahc}</span>) defined as a Fermi-sea integral of Berry curvature</p>
<p><span class="math">\begin{equation}
\sigma^{\rm AHC}_{xy} = -\frac{e^2}{\hbar} \sum_n^{\rm occ} \int\frac{d\mathbf{k}}{(2\pi)^3} \Omega^n_\gamma
\label{eq:ahc}\tag{1}
\end{equation}</span></p>
<p>we need a very dense grid. The calculation is done again, by using the calculators. AHC may be viewed as a function of the Fermi level. Such calculators are called <a class="reference external" href="https://wannier-berri.org/docs/calculators.html#static-dependent-only-on-fermi-level">StaticCalculator</a> , because the corresponding effects can be measured in static fields. (as opposed to dynamic calculators, see below).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>calculators = {}
Efermi = np.linspace(12,13,101)
omega = np.linspace(0,1.,101)
# Set a grid
grid = wberri.Grid(system, length=50 )   # length [ Ang] ~= 2*pi/dk

calculators [&quot;ahc&quot;] = wberri.calculators.static.AHC(Efermi=Efermi)

result_run = wberri.run(system,
            grid=grid,
            calculators = calculators,
            parallel=parallel,
            adpt_num_iter=5,
            fout_name=&#39;Fe&#39;,
            restart=False,
            file_Klist=&quot;Klist_ahc.pickle&quot;  # needed to restart a calculation in future
            )
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Minimal symmetric FFT grid :  [4 4 4]
<span class="ansi-red-intense-fg ansi-bold">Starting run()</span>
<span class="ansi-cyan-intense-fg ansi-bold">Using the follwing calculators :
############################################################
</span>
<span class="ansi-magenta-intense-fg ansi-bold"> &#39;ahc&#39; </span> : <span class="ansi-yellow-intense-fg ansi-bold"> &lt;wannierberri.calculators.static.AHC object at 0x754e886a3560&gt; </span> : Anomalous Hall conductivity (:math:`s^3 \cdot A^2 / (kg \cdot m^3) = S/m`)

        | With Fermi sea integral Eq(11) in `Ref &lt;https://www.nature.com/articles/s41524-021-00498-5&gt;`__
        | Output: :math:`O = -e^2/\hbar \int [dk] \Omega f`
        | Instruction: :math:`j_\alpha = \sigma_{\alpha\beta} E_\beta = \epsilon_{\alpha\beta\delta} O_\delta E_\beta`
<span class="ansi-cyan-intense-fg ansi-bold">############################################################</span>
Calculation on  grid - checking calculators for compatibility
ahc &lt;wannierberri.calculators.static.AHC object at 0x754e886a3560&gt;
All calculators are compatible
Grid is regular
The set of k points is a Grid() with NKdiv=[5 5 5], NKFFT=[5 5 5], NKtot=[25 25 25]
generating K_list
Done in 0.0007302761077880859 s
excluding symmetry-equivalent K-points from initial grid
Done in 0.006949186325073242 s
K_list contains 18 Irreducible points(14.4%) out of initial 5x5x5=125 grid
Done, sum of weights:1.0000000000000004
processing 18 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing     18 K-points on   2 processes:     0.5668 ; per K-point          0.0315 ; proc-sec per K-point          0.0630
time1 =  0.00035452842712402344
time2 =  0.0017876625061035156
exclude dbg 1 4 [-0.05 -0.05  0.05] [ 0.05 -0.05 -0.05] 8 8
exclude dbg 1 3 [-0.05 -0.05  0.05] [-0.05  0.05  0.05] 8 8
exclude dbg 1 6 [-0.05 -0.05  0.05] [ 0.05  0.05 -0.05] 8 8
exclude dbg 0 7 [-0.05 -0.05 -0.05] [0.05 0.05 0.05] 8 8
exclude dbg 2 5 [-0.05  0.05 -0.05] [ 0.05 -0.05  0.05] 8 8
checking for equivalent points in all points (of new  3 points)
excluded 0 points
sum of weights now :1.0000000000000004
Writing file_Klist_factor_changed to Klist_ahc.changed_factors.txt
processing 3 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing      3 K-points on   2 processes:     0.1161 ; per K-point          0.0387 ; proc-sec per K-point          0.0774
time1 =  0.0001342296600341797
time2 =  0.0015513896942138672
exclude dbg 1 4 [0.15 0.55 0.25] [0.25 0.55 0.15] 8 8
exclude dbg 3 6 [0.15 0.65 0.25] [0.25 0.65 0.15] 8 8
checking for equivalent points in all points (of new  6 points)
excluded 0 points
sum of weights now :1.0000000000000004
Writing file_Klist_factor_changed to Klist_ahc.changed_factors.txt
processing 6 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing      6 K-points on   2 processes:     0.1915 ; per K-point          0.0319 ; proc-sec per K-point          0.0638
time1 =  0.0001652240753173828
time2 =  0.0014939308166503906
exclude dbg 1 6 [0.35 0.15 0.25] [0.45 0.25 0.15] 8 8
exclude dbg 1 3 [0.35 0.35 0.45] [0.35 0.45 0.45] 8 8
exclude dbg 1 4 [0.35 0.35 0.45] [0.45 0.35 0.35] 8 8
exclude dbg 1 6 [0.35 0.35 0.45] [0.45 0.45 0.35] 8 8
checking for equivalent points in all points (of new  12 points)
excluded 0 points
sum of weights now :1.0000000000000004
Writing file_Klist_factor_changed to Klist_ahc.changed_factors.txt
processing 12 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing     12 K-points on   2 processes:     0.3359 ; per K-point          0.0280 ; proc-sec per K-point          0.0560
time1 =  0.00027108192443847656
time2 =  0.0015766620635986328
exclude dbg 1 6 [0.55 0.15 0.25] [0.65 0.25 0.15] 8 8
exclude dbg 1 3 [0.425 0.425 0.475] [0.425 0.475 0.475] 8 8
exclude dbg 1 4 [0.425 0.425 0.475] [0.475 0.425 0.425] 8 8
exclude dbg 1 6 [0.425 0.425 0.475] [0.475 0.475 0.425] 8 8
checking for equivalent points in all points (of new  12 points)
exclude dbg 32 41 [0.45 0.15 0.25] [0.55 0.25 0.15] 51 12
excluded 1 points
sum of weights now :1.0000000000000004
Writing file_Klist_factor_changed to Klist_ahc.changed_factors.txt
processing 11 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing     11 K-points on   2 processes:     0.3894 ; per K-point          0.0354 ; proc-sec per K-point          0.0708
time1 =  0.0002384185791015625
time2 =  0.0014297962188720703
exclude dbg 1 3 [0.15 0.15 0.25] [0.15 0.25 0.25] 8 8
exclude dbg 1 4 [0.15 0.15 0.25] [0.25 0.15 0.15] 8 8
exclude dbg 1 6 [0.15 0.15 0.25] [0.25 0.25 0.15] 8 8
checking for equivalent points in all points (of new  5 points)
exclude dbg 29 53 [0.35 0.25 0.15] [0.25 0.15 0.25] 55 5
excluded 1 points
sum of weights now :1.0000000000000002
Writing file_Klist_factor_changed to Klist_ahc.changed_factors.txt
processing 4 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing      4 K-points on   2 processes:     0.1340 ; per K-point          0.0335 ; proc-sec per K-point          0.0670
time1 =  0.00018739700317382812
Totally processed 54 K-points
run() finished
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>!ls
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bands                 Fe-ahc_iter-0014.dat
Fe-ahc_iter-0000.dat  Fe-ahc_iter-0014.npz
Fe-ahc_iter-0000.npz  Fe-ahc_iter-0015.dat
Fe-ahc_iter-0001.dat  Fe-ahc_iter-0015.npz
Fe-ahc_iter-0001.npz  Fe-ahc_notetra-run_iter-0000.dat
Fe-ahc_iter-0002.dat  Fe-ahc_notetra-run_iter-0000.npz
Fe-ahc_iter-0002.npz  Fe-ahc_tetra-run_iter-0000.dat
Fe-ahc_iter-0003.dat  Fe-ahc_tetra-run_iter-0000.npz
Fe-ahc_iter-0003.npz  Fe_bands+berry.pdf
Fe-ahc_iter-0004.dat  Fe_bands+QE.pdf
Fe-ahc_iter-0004.npz  Fe_bands+w90.pdf
Fe-ahc_iter-0005.dat  Fe-dos_notetra-run2_iter-0000.dat
Fe-ahc_iter-0005.npz  Fe-dos_notetra-run2_iter-0000.npz
Fe-ahc_iter-0006.dat  Fe-dos_tetra-run2_iter-0000.dat
Fe-ahc_iter-0006.npz  Fe-dos_tetra-run2_iter-0000.npz
Fe-ahc_iter-0007.dat  Fe_grid_berry_curvature-z.frmsf
Fe-ahc_iter-0007.npz  Fe-opt_conductivity-run3_iter-0000.dat
Fe-ahc_iter-0008.dat  Fe-opt_conductivity-run3_iter-0000.npz
Fe-ahc_iter-0008.npz  Fe-opt_conductivity-run_iter-0000.dat
Fe-ahc_iter-0009.dat  Fe-opt_conductivity-run_iter-0000.npz
Fe-ahc_iter-0009.npz  Fe-tabulate-run.npz
Fe-ahc_iter-0010.dat  input
Fe-ahc_iter-0010.npz  Klist_ahc.changed_factors.txt
Fe-ahc_iter-0011.dat  Klist_ahc.pickle
Fe-ahc_iter-0011.npz  result-tabulate.npz
Fe-ahc_iter-0012.dat  tutorial-wb-basic.ipynb
Fe-ahc_iter-0012.npz  tutorial-wb-basic-solution.ipynb
Fe-ahc_iter-0013.dat  w90_files
Fe-ahc_iter-0013.npz
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#plot results from different iterations
#plot results from different iterations
for i in range(5):
    res = np.load(f&quot;Fe-ahc_iter-{i:04d}.npz&quot;)
    # print (list(res.keys()))
    ef = res[&quot;Energies_0&quot;]
    ahc_xy = res[&quot;data&quot;][:,2]
    # alternatively from text files:
    # a = np.loadtxt(f&quot;Fe-ahc_iter-{i:04d}.dat&quot;)
    # ef = a[:,0]
    # ahc_xy = a[:,3]
    plt.plot(ef,ahc_xy,label = f&quot;iteration-{i}&quot;)
#plt.ylim(-1000,1000)
plt.xlabel(&quot;E [eV]&quot;)
plt.ylabel(&quot;AHC (S/m)&quot;)
plt.legend()
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_38_0.png" src="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_38_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>result_run = wberri.run(system,
            grid=grid,
            calculators = calculators,
            parallel=parallel,
            adpt_num_iter=10,
            fout_name=&#39;Fe&#39;,
            restart=True,
            file_Klist=&quot;Klist_ahc.pickle&quot;  # needed to restart a calculation
            )
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">Starting run()</span>
<span class="ansi-cyan-intense-fg ansi-bold">Using the follwing calculators :
############################################################
</span>
<span class="ansi-magenta-intense-fg ansi-bold"> &#39;ahc&#39; </span> : <span class="ansi-yellow-intense-fg ansi-bold"> &lt;wannierberri.calculators.static.AHC object at 0x754e886a3560&gt; </span> : Anomalous Hall conductivity (:math:`s^3 \cdot A^2 / (kg \cdot m^3) = S/m`)

        | With Fermi sea integral Eq(11) in `Ref &lt;https://www.nature.com/articles/s41524-021-00498-5&gt;`__
        | Output: :math:`O = -e^2/\hbar \int [dk] \Omega f`
        | Instruction: :math:`j_\alpha = \sigma_{\alpha\beta} E_\beta = \epsilon_{\alpha\beta\delta} O_\delta E_\beta`
<span class="ansi-cyan-intense-fg ansi-bold">############################################################</span>
Calculation on  grid - checking calculators for compatibility
ahc &lt;wannierberri.calculators.static.AHC object at 0x754e886a3560&gt;
All calculators are compatible
Grid is regular
The set of k points is a Grid() with NKdiv=[5 5 5], NKFFT=[5 5 5], NKtot=[25 25 25]
Finished reading Klist from file Klist_ahc.pickle
54 K-points were read from Klist_ahc.pickle
9 K-points were read from Klist_ahc.changed_factors.txt
searching for start_iter
start_iter = 0
nothing to process now
time1 =  0.0008006095886230469
time2 =  0.0004322528839111328
exclude dbg 1 3 [0.325 0.325 0.375] [0.325 0.375 0.375] 8 8
exclude dbg 1 4 [0.325 0.325 0.375] [0.375 0.325 0.325] 8 8
exclude dbg 1 6 [0.325 0.325 0.375] [0.375 0.375 0.325] 8 8
exclude dbg 1 6 [ 0.15 -0.05  0.05] [ 0.25  0.05 -0.05] 8 8
checking for equivalent points in all points (of new  12 points)
exclude dbg 20 61 [-0.05  0.05 -0.05] [ 0.15  0.05 -0.05] 66 12
excluded 1 points
sum of weights now :1.0000000000000002
Writing file_Klist_factor_changed to Klist_ahc.changed_factors.txt
processing 11 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing     11 K-points on   2 processes:     0.3528 ; per K-point          0.0321 ; proc-sec per K-point          0.0642
time1 =  0.0002334117889404297
time2 =  0.0018079280853271484
exclude dbg 1 4 [-0.075  0.025 -0.025] [-0.025  0.025 -0.075] 8 8
exclude dbg 3 6 [-0.075  0.075 -0.025] [-0.025  0.075 -0.075] 8 8
checking for equivalent points in all points (of new  6 points)
excluded 0 points
sum of weights now :1.0
Writing file_Klist_factor_changed to Klist_ahc.changed_factors.txt
processing 6 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing      6 K-points on   2 processes:     0.2000 ; per K-point          0.0333 ; proc-sec per K-point          0.0667
time1 =  0.0001735687255859375
time2 =  0.0015294551849365234
exclude dbg 1 4 [-0.0875  0.0625 -0.0625] [-0.0625  0.0625 -0.0875] 8 8
exclude dbg 3 6 [-0.0875  0.0875 -0.0625] [-0.0625  0.0875 -0.0875] 8 8
checking for equivalent points in all points (of new  6 points)
excluded 0 points
sum of weights now :1.0
Writing file_Klist_factor_changed to Klist_ahc.changed_factors.txt
processing 6 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing      6 K-points on   2 processes:     0.1858 ; per K-point          0.0310 ; proc-sec per K-point          0.0619
time1 =  0.00020551681518554688
time2 =  0.00154876708984375
exclude dbg 1 6 [0.425 0.225 0.275] [0.475 0.275 0.225] 8 8
exclude dbg 1 4 [-0.0375  0.0125 -0.0125] [-0.0125  0.0125 -0.0375] 8 8
exclude dbg 3 6 [-0.0375  0.0375 -0.0125] [-0.0125  0.0375 -0.0375] 8 8
checking for equivalent points in all points (of new  13 points)
excluded 0 points
sum of weights now :1.0
Writing file_Klist_factor_changed to Klist_ahc.changed_factors.txt
processing 13 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing     13 K-points on   2 processes:     0.4261 ; per K-point          0.0328 ; proc-sec per K-point          0.0656
time1 =  0.0002701282501220703
time2 =  0.0014667510986328125
exclude dbg 4 6 [0.65 0.35 0.15] [0.65 0.45 0.15] 8 8
exclude dbg 1 3 [0.55 0.35 0.25] [0.55 0.45 0.25] 8 8
exclude dbg 1 6 [ 0.35 -0.05  0.05] [ 0.45  0.05 -0.05] 8 8
checking for equivalent points in all points (of new  13 points)
exclude dbg 63 98 [ 0.25 -0.05  0.05] [ 0.35  0.05 -0.05] 103 13
exclude dbg 32 92 [0.45 0.15 0.25] [0.55 0.45 0.15] 103 13
excluded 2 points
sum of weights now :1.0
Writing file_Klist_factor_changed to Klist_ahc.changed_factors.txt
processing 11 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing     11 K-points on   2 processes:     0.3535 ; per K-point          0.0321 ; proc-sec per K-point          0.0643
time1 =  0.0003020763397216797
time2 =  0.0015151500701904297
exclude dbg 1 6 [0.325 0.025 0.075] [0.375 0.075 0.025] 8 8
checking for equivalent points in all points (of new  7 points)
excluded 0 points
sum of weights now :1.0
Writing file_Klist_factor_changed to Klist_ahc.changed_factors.txt
processing 7 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing      7 K-points on   2 processes:     0.2299 ; per K-point          0.0328 ; proc-sec per K-point          0.0657
time1 =  0.00017333030700683594
time2 =  0.0015294551849365234
exclude dbg 0 7 [0.75 0.35 0.15] [0.85 0.45 0.25] 8 8
checking for equivalent points in all points (of new  15 points)
exclude dbg 43 113 [0.65 0.15 0.25] [0.85 0.35 0.25] 123 15
exclude dbg 25 117 [0.25 0.55 0.25] [ 0.55  0.25 -0.05] 123 15
excluded 2 points
sum of weights now :1.0
Writing file_Klist_factor_changed to Klist_ahc.changed_factors.txt
processing 13 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing     13 K-points on   2 processes:     0.4025 ; per K-point          0.0310 ; proc-sec per K-point          0.0619
time1 =  0.0002453327178955078
time2 =  0.0013992786407470703
exclude dbg 1 6 [ 0.225 -0.075 -0.025] [ 0.275 -0.025 -0.075] 8 8
checking for equivalent points in all points (of new  15 points)
excluded 0 points
sum of weights now :1.0000000000000002
Writing file_Klist_factor_changed to Klist_ahc.changed_factors.txt
processing 15 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing     15 K-points on   2 processes:     0.4533 ; per K-point          0.0302 ; proc-sec per K-point          0.0604
time1 =  0.00023889541625976562
time2 =  0.0013899803161621094
exclude dbg 1 3 [0.35 0.15 0.05] [0.35 0.25 0.05] 8 8
exclude dbg 4 6 [ 0.45  0.15 -0.05] [ 0.45  0.25 -0.05] 8 8
exclude dbg 0 7 [0.55 0.35 0.35] [0.65 0.45 0.45] 8 8
exclude dbg 1 6 [0.55 0.35 0.45] [0.65 0.45 0.35] 8 8
checking for equivalent points in all points (of new  20 points)
exclude dbg 63 138 [ 0.25 -0.05  0.05] [ 0.35  0.25 -0.05] 156 20
exclude dbg 93 147 [0.65 0.35 0.25] [0.65 0.35 0.45] 156 20
exclude dbg 37 144 [0.45 0.35 0.45] [0.55 0.45 0.35] 156 20
excluded 3 points
sum of weights now :1.0000000000000004
Writing file_Klist_factor_changed to Klist_ahc.changed_factors.txt
processing 17 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing     17 K-points on   2 processes:     0.5119 ; per K-point          0.0301 ; proc-sec per K-point          0.0602
time1 =  0.0003383159637451172
time2 =  0.0017049312591552734
exclude dbg 1 4 [-0.05  0.15  0.05] [ 0.05  0.15 -0.05] 8 8
exclude dbg 0 7 [-0.05  0.15 -0.05] [0.05 0.25 0.05] 8 8
exclude dbg 3 6 [-0.05  0.25  0.05] [ 0.05  0.25 -0.05] 8 8
exclude dbg 1 3 [0.4125 0.4125 0.4375] [0.4125 0.4375 0.4375] 8 8
exclude dbg 1 4 [0.4125 0.4125 0.4375] [0.4375 0.4125 0.4125] 8 8
exclude dbg 1 6 [0.4125 0.4125 0.4375] [0.4375 0.4375 0.4125] 8 8
checking for equivalent points in all points (of new  10 points)
exclude dbg 20 157 [-0.05  0.05 -0.05] [0.05 0.15 0.05] 163 10
excluded 1 points
sum of weights now :1.0000000000000009
Writing file_Klist_factor_changed to Klist_ahc.changed_factors.txt
processing 9 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing      9 K-points on   2 processes:     0.2839 ; per K-point          0.0315 ; proc-sec per K-point          0.0631
time1 =  0.0002143383026123047
Totally processed 108 K-points
run() finished
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#plot results from different iterations
for i in range(10,15):
    res = np.load(f&quot;Fe-ahc_iter-{i:04d}.npz&quot;)
    # print (list(res.keys()))
    ef = res[&quot;Energies_0&quot;]
    ahc_xy = res[&quot;data&quot;][:,2]
    # alternatively from text files:
    # a = np.loadtxt(f&quot;Fe-ahc_iter-{i:04d}.dat&quot;)
    # ef = a[:,0]
    # ahc_xy = a[:,3]
    plt.plot(ef,ahc_xy,label = f&quot;iteration-{i}&quot;)
#plt.ylim(-1000,1000)
plt.xlabel(&quot;E [eV]&quot;)
plt.ylabel(&quot;AHC (S/m)&quot;)
plt.legend()
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_40_0.png" src="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_40_0.png" />
</div>
</div>
<section id="Problem-3-:">
<h3>Problem 3 :<a class="headerlink" href="#Problem-3-:" title="Link to this heading"></a></h3>
<p>start from a denser grid (length=100 or 200) and do the integration again with 20 iterations. Plot the results</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># insert the needed code below
<br/><br/><br/></pre></div>
</div>
</div>
</section>
</section>
<section id="Tetrahedron-method">
<h2>Tetrahedron method<a class="headerlink" href="#Tetrahedron-method" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>calculators = {}
Efermi = np.linspace(12,13,101)
omega = np.linspace(0,1.,101)
# Set a grid
grid = wberri.Grid(system, length=50 )   # length [ Ang] ~= 2*pi/dk

calculators [&quot;dos_notetra&quot;] = wberri.calculators.static.DOS(Efermi=Efermi,tetra=False)
calculators [&quot;dos_tetra&quot;] = wberri.calculators.static.DOS(Efermi=Efermi,tetra=True)

result_run = wberri.run(system,
            grid=grid,
            calculators = calculators,
            parallel=parallel,
            adpt_num_iter=0,
            fout_name=&#39;Fe&#39;,
            suffix = &quot;run2&quot;,
            restart=False,
            print_Kpoints=False
            )

a = np.loadtxt(f&quot;Fe-dos_notetra-run2_iter-0000.dat&quot;)
plt.plot(a[:,0],a[:,1],label = f&quot;no tetra&quot;)
a = np.loadtxt(f&quot;Fe-dos_tetra-run2_iter-0000.dat&quot;)
plt.plot(a[:,0],a[:,1],label = f&quot;tetra&quot;)
plt.legend()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Minimal symmetric FFT grid :  [4 4 4]
<span class="ansi-red-intense-fg ansi-bold">Starting run()</span>
<span class="ansi-cyan-intense-fg ansi-bold">Using the follwing calculators :
############################################################
</span>
<span class="ansi-magenta-intense-fg ansi-bold"> &#39;dos_notetra&#39; </span> : <span class="ansi-yellow-intense-fg ansi-bold"> &lt;wannierberri.calculators.static.DOS object at 0x754f083e87d0&gt; </span> : Density of states
<span class="ansi-magenta-intense-fg ansi-bold"> &#39;dos_tetra&#39; </span> : <span class="ansi-yellow-intense-fg ansi-bold"> &lt;wannierberri.calculators.static.DOS object at 0x754e886b8740&gt; </span> : Density of states
<span class="ansi-cyan-intense-fg ansi-bold">############################################################</span>
Calculation on  grid - checking calculators for compatibility
dos_notetra &lt;wannierberri.calculators.static.DOS object at 0x754f083e87d0&gt;
dos_tetra &lt;wannierberri.calculators.static.DOS object at 0x754e886b8740&gt;
All calculators are compatible
Grid is regular
The set of k points is a Grid() with NKdiv=[5 5 5], NKFFT=[5 5 5], NKtot=[25 25 25]
generating K_list
Done in 0.0006368160247802734 s
excluding symmetry-equivalent K-points from initial grid
Done in 0.008691549301147461 s
K_list contains 18 Irreducible points(14.4%) out of initial 5x5x5=125 grid
Done, sum of weights:1.0000000000000004
processing 18 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing     18 K-points on   2 processes:     2.2826 ; per K-point          0.1268 ; proc-sec per K-point          0.2536
time1 =  0.00025725364685058594
Totally processed 18 K-points
run() finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x754e884c0ce0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_44_2.png" src="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_44_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>!ls
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bands                 Fe-ahc_iter-0014.dat
Fe-ahc_iter-0000.dat  Fe-ahc_iter-0014.npz
Fe-ahc_iter-0000.npz  Fe-ahc_iter-0015.dat
Fe-ahc_iter-0001.dat  Fe-ahc_iter-0015.npz
Fe-ahc_iter-0001.npz  Fe-ahc_notetra-run_iter-0000.dat
Fe-ahc_iter-0002.dat  Fe-ahc_notetra-run_iter-0000.npz
Fe-ahc_iter-0002.npz  Fe-ahc_tetra-run_iter-0000.dat
Fe-ahc_iter-0003.dat  Fe-ahc_tetra-run_iter-0000.npz
Fe-ahc_iter-0003.npz  Fe_bands+berry.pdf
Fe-ahc_iter-0004.dat  Fe_bands+QE.pdf
Fe-ahc_iter-0004.npz  Fe_bands+w90.pdf
Fe-ahc_iter-0005.dat  Fe-dos_notetra-run2_iter-0000.dat
Fe-ahc_iter-0005.npz  Fe-dos_notetra-run2_iter-0000.npz
Fe-ahc_iter-0006.dat  Fe-dos_tetra-run2_iter-0000.dat
Fe-ahc_iter-0006.npz  Fe-dos_tetra-run2_iter-0000.npz
Fe-ahc_iter-0007.dat  Fe_grid_berry_curvature-z.frmsf
Fe-ahc_iter-0007.npz  Fe-opt_conductivity-run3_iter-0000.dat
Fe-ahc_iter-0008.dat  Fe-opt_conductivity-run3_iter-0000.npz
Fe-ahc_iter-0008.npz  Fe-opt_conductivity-run_iter-0000.dat
Fe-ahc_iter-0009.dat  Fe-opt_conductivity-run_iter-0000.npz
Fe-ahc_iter-0009.npz  Fe-tabulate-run.npz
Fe-ahc_iter-0010.dat  input
Fe-ahc_iter-0010.npz  Klist_ahc.changed_factors.txt
Fe-ahc_iter-0011.dat  Klist_ahc.pickle
Fe-ahc_iter-0011.npz  result-tabulate.npz
Fe-ahc_iter-0012.dat  tutorial-wb-basic.ipynb
Fe-ahc_iter-0012.npz  tutorial-wb-basic-solution.ipynb
Fe-ahc_iter-0013.dat  w90_files
Fe-ahc_iter-0013.npz
</pre></div></div>
</div>
</section>
<section id="Optical-conductivity">
<h2>Optical conductivity<a class="headerlink" href="#Optical-conductivity" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>calculators = {}
Efermi = np.linspace(12,13,101)
omega = np.linspace(0,1.,101)
# Set a grid
grid = wberri.Grid(system, length=50 )   # length [ Ang] ~= 2*pi/dk

calculators[&quot;opt_conductivity&quot;] = wberri.calculators.dynamic.OpticalConductivity(
                            Efermi=Efermi,omega=omega)


result_run_opt = wberri.run(system,
            grid=grid,
            calculators = calculators,
            parallel=parallel,
            adpt_num_iter=0,
            fout_name=&#39;Fe&#39;,
            suffix = &quot;run3&quot;,
            restart=False,
            )
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Minimal symmetric FFT grid :  [4 4 4]
<span class="ansi-red-intense-fg ansi-bold">Starting run()</span>
<span class="ansi-cyan-intense-fg ansi-bold">Using the follwing calculators :
############################################################
</span>
<span class="ansi-magenta-intense-fg ansi-bold"> &#39;opt_conductivity&#39; </span> : <span class="ansi-yellow-intense-fg ansi-bold"> &lt;wannierberri.calculators.dynamic.OpticalConductivity object at 0x775a6c4f49e0&gt; </span> : calculator not described
<span class="ansi-cyan-intense-fg ansi-bold">############################################################</span>
Calculation on  grid - checking calculators for compatibility
opt_conductivity &lt;wannierberri.calculators.dynamic.OpticalConductivity object at 0x775a6c4f49e0&gt;
All calculators are compatible
Grid is regular
The set of k points is a Grid() with NKdiv=[5 5 5], NKFFT=[5 5 5], NKtot=[25 25 25]
generating K_list
Done in 0.0002636909484863281 s
excluding symmetry-equivalent K-points from initial grid
Done in 0.003238201141357422 s
K_list contains 18 Irreducible points(14.4%) out of initial 5x5x5=125 grid
Done, sum of weights:1.0000000000000004
processing 18 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing     18 K-points on   2 processes:     6.7558 ; per K-point          0.3753 ; proc-sec per K-point          0.7506
time1 =  0.003773212432861328
Totally processed 18 K-points
run() finished
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#plot results from new iterations
res = result_run_opt.results[&quot;opt_conductivity&quot;]
print (res.data.shape)
print (res.Energies[0]) # Efermi
print (res.Energies[1]) # omega

# plot at fixed omega
iw = 10
plt.plot(res.Energies[0], res.data[:,iw,2,2].imag)
plt.show()

# plot at fixed Efermi
ief = 20
plt.plot(res.Energies[1], res.data[ief,:,2,2].imag)
plt.show()
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(101, 101, 3, 3)
[12.   12.01 12.02 12.03 12.04 12.05 12.06 12.07 12.08 12.09 12.1  12.11
 12.12 12.13 12.14 12.15 12.16 12.17 12.18 12.19 12.2  12.21 12.22 12.23
 12.24 12.25 12.26 12.27 12.28 12.29 12.3  12.31 12.32 12.33 12.34 12.35
 12.36 12.37 12.38 12.39 12.4  12.41 12.42 12.43 12.44 12.45 12.46 12.47
 12.48 12.49 12.5  12.51 12.52 12.53 12.54 12.55 12.56 12.57 12.58 12.59
 12.6  12.61 12.62 12.63 12.64 12.65 12.66 12.67 12.68 12.69 12.7  12.71
 12.72 12.73 12.74 12.75 12.76 12.77 12.78 12.79 12.8  12.81 12.82 12.83
 12.84 12.85 12.86 12.87 12.88 12.89 12.9  12.91 12.92 12.93 12.94 12.95
 12.96 12.97 12.98 12.99 13.  ]
[0.   0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1  0.11 0.12 0.13
 0.14 0.15 0.16 0.17 0.18 0.19 0.2  0.21 0.22 0.23 0.24 0.25 0.26 0.27
 0.28 0.29 0.3  0.31 0.32 0.33 0.34 0.35 0.36 0.37 0.38 0.39 0.4  0.41
 0.42 0.43 0.44 0.45 0.46 0.47 0.48 0.49 0.5  0.51 0.52 0.53 0.54 0.55
 0.56 0.57 0.58 0.59 0.6  0.61 0.62 0.63 0.64 0.65 0.66 0.67 0.68 0.69
 0.7  0.71 0.72 0.73 0.74 0.75 0.76 0.77 0.78 0.79 0.8  0.81 0.82 0.83
 0.84 0.85 0.86 0.87 0.88 0.89 0.9  0.91 0.92 0.93 0.94 0.95 0.96 0.97
 0.98 0.99 1.  ]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_48_1.png" src="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_48_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_48_2.png" src="../../_images/tutorials_1_basic_tutorial-wb-basic-solution_48_2.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>!ls
</pre></div>
</div>
</div>
</section>
<section id="All-in-one">
<h2>All in one<a class="headerlink" href="#All-in-one" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>calculators = {}
Efermi = np.linspace(12,13,101)
omega = np.linspace(0,1.,101)
# Set a grid
grid = wberri.Grid(system, length=50 )   # length [ Ang] ~= 2*pi/dk

calculators [&quot;ahc_notetra&quot;] = wberri.calculators.static.AHC(Efermi=Efermi,tetra=False)
calculators [&quot;ahc_tetra&quot;] = wberri.calculators.static.AHC(Efermi=Efermi,tetra=True)
calculators [&quot;tabulate&quot;] = wberri.calculators.TabulatorAll({
                            &quot;Energy&quot;:wberri.calculators.tabulate.Energy(),
                            &quot;berry&quot;:wberri.calculators.tabulate.BerryCurvature(),
                                  },
                            ibands = np.arange(4,10))
calculators[&quot;opt_conductivity&quot;] = wberri.calculators.dynamic.OpticalConductivity(
                            Efermi=Efermi,omega=omega)


result_run = wberri.run(system,
            grid=grid,
            calculators = calculators,
            parallel=parallel,
            adpt_num_iter=0,
            fout_name=&#39;Fe&#39;,
            suffix = &quot;run&quot;,
            restart=False,
            )
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Minimal symmetric FFT grid :  [4 4 4]
<span class="ansi-red-intense-fg ansi-bold">Starting run()</span>
<span class="ansi-cyan-intense-fg ansi-bold">Using the follwing calculators :
############################################################
</span>
<span class="ansi-magenta-intense-fg ansi-bold"> &#39;ahc_notetra&#39; </span> : <span class="ansi-yellow-intense-fg ansi-bold"> &lt;wannierberri.calculators.static.AHC object at 0x775a6426fc20&gt; </span> : Anomalous Hall conductivity (:math:`s^3 \cdot A^2 / (kg \cdot m^3) = S/m`)

        | With Fermi sea integral Eq(11) in `Ref &lt;https://www.nature.com/articles/s41524-021-00498-5&gt;`__
        | Output: :math:`O = -e^2/\hbar \int [dk] \Omega f`
        | Instruction: :math:`j_\alpha = \sigma_{\alpha\beta} E_\beta = \epsilon_{\alpha\beta\delta} O_\delta E_\beta`
<span class="ansi-magenta-intense-fg ansi-bold"> &#39;ahc_tetra&#39; </span> : <span class="ansi-yellow-intense-fg ansi-bold"> &lt;wannierberri.calculators.static.AHC object at 0x775a5e7f2300&gt; </span> : Anomalous Hall conductivity (:math:`s^3 \cdot A^2 / (kg \cdot m^3) = S/m`)

        | With Fermi sea integral Eq(11) in `Ref &lt;https://www.nature.com/articles/s41524-021-00498-5&gt;`__
        | Output: :math:`O = -e^2/\hbar \int [dk] \Omega f`
        | Instruction: :math:`j_\alpha = \sigma_{\alpha\beta} E_\beta = \epsilon_{\alpha\beta\delta} O_\delta E_\beta`
<span class="ansi-magenta-intense-fg ansi-bold"> &#39;tabulate&#39; </span> : <span class="ansi-yellow-intense-fg ansi-bold"> &lt;wannierberri.calculators.tabulate.TabulatorAll object at 0x775a5e7ce090&gt; </span> :
    TabulatorAll - a pack of all k-resolved calculators (Tabulators)

 Includes the following tabulators :
--------------------------------------------------
 &#34;Energy&#34; : &lt;wannierberri.calculators.tabulate.Energy object at 0x775a5e7f26c0&gt; : calculator not described

 &#34;berry&#34; : &lt;wannierberri.calculators.tabulate.BerryCurvature object at 0x775a5e7ce9f0&gt; : calculator not described

--------------------------------------------------

<span class="ansi-magenta-intense-fg ansi-bold"> &#39;opt_conductivity&#39; </span> : <span class="ansi-yellow-intense-fg ansi-bold"> &lt;wannierberri.calculators.dynamic.OpticalConductivity object at 0x775a5e7f2960&gt; </span> : calculator not described
<span class="ansi-cyan-intense-fg ansi-bold">############################################################</span>
Calculation on  grid - checking calculators for compatibility
ahc_notetra &lt;wannierberri.calculators.static.AHC object at 0x775a6426fc20&gt;
ahc_tetra &lt;wannierberri.calculators.static.AHC object at 0x775a5e7f2300&gt;
tabulate &lt;wannierberri.calculators.tabulate.TabulatorAll object at 0x775a5e7ce090&gt;
opt_conductivity &lt;wannierberri.calculators.dynamic.OpticalConductivity object at 0x775a5e7f2960&gt;
All calculators are compatible
Grid is regular
The set of k points is a Grid() with NKdiv=[5 5 5], NKFFT=[5 5 5], NKtot=[25 25 25]
generating K_list
Done in 0.0006458759307861328 s
excluding symmetry-equivalent K-points from initial grid
Done in 0.004869937896728516 s
K_list contains 18 Irreducible points(14.4%) out of initial 5x5x5=125 grid
Done, sum of weights:1.0000000000000004
processing 18 K points : using  2 processes.
# K-points calculated  Wall time (sec)  Est. remaining (sec)
time for processing     18 K-points on   2 processes:     8.4348 ; per K-point          0.4686 ; proc-sec per K-point          0.9372
time1 =  0.008688211441040039
setting the grid
setting new kpoints
finding equivalent kpoints
collecting
collecting: to_grid  : 0.06287646293640137
collecting: TABresult  : 0.0002505779266357422
collecting - OK : 0.06314754486083984 (2.0503997802734375e-05)
Totally processed 18 K-points
run() finished
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../index.html" class="btn btn-neutral float-left" title="Wannier Berri Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../2_fermi_sea_vs_fermi_surface/solution/tutorial_sea_vs_surface_solution.html" class="btn btn-neutral float-right" title="WannierBerri advanced tutorial - Fermi surface and Fermi sea calculation of the Berry curvature dipole" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Stepan Tsirkin.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>